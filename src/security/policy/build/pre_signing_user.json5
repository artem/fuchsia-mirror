// This policy enforces platform-level contraints on Fuchsia user builds at build time.
// It is consumed by Scrutiny and defines assorted checks that are not currently categorized
// under the existing component, routing, or package allowlist-based verifiers.
// This should be run in addition to any product-specific policy.
// See https://fuchsia.dev/fuchsia-src/contribute/governance/rfcs/0115_build_types for more
// detail on build type strategy.
{
    additional_boot_args_checks: {
        // Ensure netsvc is disabled on non-eng builds.
        // netsvc allows for execution of unverified code via netbooting and is not suitable for
        // use outside of dev environments.
        must_not_contain: [
            {
                KeyValuePair: [
                    "netsvc.all-features",
                    "true",
                ],
            },
            {
                KeyValuePair: [
                    "netsvc.netboot",
                    "true",
                ],
            },
        ],
    },
}
