// Copyright 2023 The Fuchsia Authors.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
{
    actions: [
        {
            type: "expect_pass",
            matchers: [
                "*",
            ],
        },
        {
            type: "expect_failure",
            matchers: [
                // Uses socketcall, which does not exist on x64 or arm.
                "accept4_01",
                "add_key01",
                "add_key03",
                "adjtimex01",
                "adjtimex01",
                "adjtimex02",
                "adjtimex03",
                "aio01",
                "aio02",
                "bind02",
                "bind04",
                "bind05",
                "bpf_map01",
                "bpf_prog01",
                "bpf_prog03",
                "bpf_prog04",
                "bpf_prog05",
                "bpf_prog07",
                "clock_adjtime01",
                "clock_adjtime02",

                // Failure caused by two skipped assertions:
                //   `The libc wrapper may dereference req or rem`.
                "clock_nanosleep01",
                "clock_settime01",
                "clock_settime02",
                "clone05",
                "clone08",
                "clone09",
                "copy_file_range01",
                "cpuacct_1_1",
                "cve-2016-10044",
                "cve-2016-4997",
                "cve-2016-5195",
                "cve-2016-7042",
                "cve-2016-9604",
                "cve-2016-9793",
                "cve-2017-12192",
                "cve-2017-12193",
                "cve-2017-15274",
                "cve-2017-15299",
                "cve-2017-15537",
                "cve-2017-15951",
                "cve-2017-16995",
                "cve-2017-17053",
                "cve-2017-17807",
                "cve-2017-18075",
                "cve-2017-6951",
                "cve-2017-7308",
                "cve-2017-7472",
                "cve-2018-1000199",
                "cve-2018-12896",
                "cve-2018-18445",
                "cve-2018-5803",
                "cve-2018-8897",
                "cve-2018-9568",
                "cve-2020-29373",
                "cve-2021-4034",
                "cve-2022-2590",
                "delete_module01",
                "delete_module02",
                "delete_module03",
                "fallocate04",
                "fcntl13",
                "fcntl13_64",
                "fcntl18",
                "fcntl18_64",
                "fcntl23",
                "fcntl23_64",
                "fcntl24",
                "fcntl24_64",
                "fcntl25",
                "fcntl25_64",
                "fcntl26",
                "fcntl26_64",
                "fcntl31",
                "fcntl31_64",
                "fcntl32",
                "fcntl32_64",
                "fcntl33",
                "fcntl33_64",
                "fcntl35",
                "fcntl35_64",
                "fcntl37",
                "fcntl37_64",
                "fdatasync02",
                "fdatasync03",
                "finit_module01",
                "fork14",
                "fs_di",
                "fsconfig02",
                "fsetxattr02",
                "fstatat01",
                "fsync03",
                "ftrace_regression02",
                "futex_cmp_requeue02",
                "futex_wake04",
                "futimesat01",
                "getcpu01",

                // These getdents* tests "fail" because of skipped subtests.
                "getdents01",
                "getdents02",
                "getitimer01",
                "getpriority01",
                "getpriority02",
                "getrusage02",
                "init_module01",
                "inotify06",
                "inotify11",
                "input01",
                "input02",
                "input04",
                "input05",
                "io_cancel01",
                "io_cancel02",
                "io_destroy01",
                "io_destroy02",
                "io_getevents01",
                "io_getevents02",
                "io_pgetevents02",
                "io_setup01",
                "io_setup02",
                "io_submit01",
                "io_submit02",
                "io_submit03",
                "io_uring01",
                "ioctl07",
                "ioctl_loop04",
                "ioctl_loop05",
                "ioctl_ns02",
                "ioctl_ns03",
                "ioperm01",
                "ioperm02",
                "iopl01",
                "iopl02",
                "ioprio_get01",
                "ioprio_set01",
                "ioprio_set02",
                "ioprio_set03",
                "keyctl01",
                "keyctl03",
                "keyctl05",
                "keyctl06",
                "leapsec01",
                "lseek11",
                "madvise01",
                "madvise02",
                "madvise08",
                "madvise10",
                "membarrier01",
                "memcg_control",
                "memcg_regression",
                "memcg_test_3",
                "memcontrol02",
                "mincore01",
                "mincore02",
                "mincore03",
                "mincore04",
                "mlock01",
                "mlock02",
                "mlock04",
                "mlock201",
                "mlock202",
                "mlock203",
                "mlockall01",
                "mlockall02",
                "mlockall03",
                "mmap12",
                "mmap14",
                "mmapstress07",
                "mount02",
                "mount06",
                "mount_setattr01",
                "mprotect01",
                "msync03",
                "msync04",
                "munlock01",
                "munlock02",
                "munlockall01",
                "openat201",
                "openat202",
                "openat203",
                "perf_event_open01",
                "pivot_root01",
                "prctl01",
                "prctl02",
                "prctl06",
                "prctl07",
                "prctl08",
                "prctl10",
                "ptem01",
                "ptrace01",
                "ptrace02",
                "ptrace03",
                "ptrace05",
                "ptrace10",
                "ptrace11",
                "pwritev03",
                "pwritev03_64",
                "quotactl04",
                "quotactl08",
                "quotactl09",
                "read02",
                "readahead01",
                "readahead02",
                "readdir21",
                "remap_file_pages02",
                "request_key01",
                "request_key02",
                "request_key03",
                "rt_sigpending02",
                "rt_sigprocmask01",
                "rt_sigqueueinfo01",
                "rt_sigtimedwait01",
                "runpwtests03",
                "runpwtests04",
                "runpwtests06",
                "sched_getattr01",
                "sched_getattr02",
                "sched_rr_get_interval02",
                "sched_rr_get_interval03",
                "sched_setattr01",
                "sched_setparam01",
                "sched_setparam02",
                "sched_setparam03",
                "sched_setparam04",
                "sched_setparam05",
                "sched_setscheduler02",
                "sched_stress",

                // Two skipped test cases for select variants that do not exist in 64 bit.
                "select01",
                "select02",
                "send02",
                "sendfile02",
                "sendfile02_64",
                "sendfile04",
                "sendfile04_64",
                "sendfile05",
                "sendfile05_64",
                "set_thread_area01",
                "setitimer01",
                "setitimer02",
                "setpgid01",
                "setpriority01",
                "setrlimit01",
                "setrlimit03",
                "settimeofday01",
                "settimeofday02",
                "setxattr03",
                "sgetmask01",
                "sigaction01",
                "sigpending02",
                "sigprocmask01",
                "sigtimedwait01",
                "sigwaitinfo01",
                "smt_smp_affinity",
                "smt_smp_enabled",
                "socketcall01",
                "socketcall02",
                "socketcall03",
                "sockioctl01",
                "ssetmask01",
                "stat04",
                "stat04_64",
                "statx01",
                "statx04",
                "statx06",
                "statx08",
                "swapoff01",
                "swapoff02",
                "swapon01",
                "swapon02",
                "swapon03",
                "sync01",
                "sync_file_range01",
                "syncfs01",
                "syslog11",
                "syslog12",
                "tee01",
                "tee02",
                "tgkill02",
                "tgkill03",
                "time-schedule01",
                "timer_getoverrun01",
                "timer_gettime01",
                "timer_settime02",

                // fxbug.dev/127682
                "times03",
                "umip_basic_test",
                "umount02",
                "umount2_01",
                "umount2_02",
                "unshare01",
                "userfaultfd01",
                "ustat01",
                "ustat02",
                "vhangup01",
                "vhangup02",
                "vmsplice01",
                "vmsplice02",
                "vmsplice03",
                "vmsplice04",
                "waitid10",
                "writetest01",

                // These tests fail when an init is run in the container to set up /apex.
                // TODO(https://fxbug.dev/129839) re-enable these tests
                "ioctl_loop06",
                "mmapstress04",
            ],
        },
        {
            type: "skip",
            matchers: [
                // Flaky test.
                "cve-2017-17052",
                "io_pgetevents01",
                "rename14",
                "select03",
                "sigwait01",

                // Causes an OOM when /dev/loop-control is available.
                "fallocate05",

                // These tests hang
                "creat07",
                "fork14",

                // Makes all following tests to fail.
                "kill10",

                // Times out.
                "cve-2017-10661",

                // Timing-dependent tests that flake in QEMU and with ASan.
                // TODO(b/297390005): Skip only in QEMU and with ASan.
                "epoll_wait04",
                "futex_wait_bitset01",
                "timerfd01",
                "pipe13",
                "prctl09",
                "pth_str01",
            ],
        },
    ],
}
