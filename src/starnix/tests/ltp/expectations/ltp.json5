// Copyright 2023 The Fuchsia Authors.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
{
    actions: [
        {
            type: "expect_pass",
            matchers: [
                "*",
            ],
        },
        {
            type: "expect_failure",
            matchers: [
                // Uses socketcall, which does not exist on x64 or arm.
                "accept4_01",
                "acct02",
                "add_key01",
                "add_key01",
                "add_key03",
                "add_key05",
                "adjtimex01",
                "adjtimex01",
                "adjtimex02",
                "adjtimex03",
                "aio01",
                "aio02",
                "bind02",
                "bind04",
                "bind05",
                "block_dev",
                "bpf_map01",
                "bpf_prog01",
                "bpf_prog03",
                "bpf_prog04",
                "bpf_prog05",
                "bpf_prog07",
                "cacheflush01",
                "capget01",
                "capget02",
                "capset01",
                "capset02",
                "capset04",
                "clock_adjtime01",
                "clock_adjtime02",
                "clock_getres01",
                "clock_gettime03",
                "clock_nanosleep01",
                "clock_nanosleep03",
                "clock_settime01",
                "clock_settime02",
                "clone05",
                "clone08",
                "clone09",
                "connect01",
                "copy_file_range01",
                "cpuacct_1_1",
                "cpufreq_boost",
                "cpuhotplug05",
                "cpuhotplug07",
                "cpuset01",
                "cpuset_base_ops",
                "cpuset_exclusive",
                "cpuset_hierarchy",
                "cpuset_load_balance",
                "cpuset_memory",
                "cpuset_memory_pressure",
                "cpuset_memory_spread",
                "cpuset_sched_domains",
                "cpuset_syscall",
                "cve-2011-2183",
                "cve-2011-2496",
                "cve-2012-0957",
                "cve-2016-10044",
                "cve-2016-4997",
                "cve-2016-5195",
                "cve-2016-7042",
                "cve-2016-8655",
                "cve-2016-9604",
                "cve-2016-9793",
                "cve-2017-1000111",
                "cve-2017-1000112",
                "cve-2017-12192",
                "cve-2017-12193",
                "cve-2017-15274",
                "cve-2017-15299",
                "cve-2017-15537",
                "cve-2017-15951",
                "cve-2017-16939",
                "cve-2017-16995",
                "cve-2017-17053",
                "cve-2017-17712",
                "cve-2017-17807",
                "cve-2017-18075",
                "cve-2017-6951",
                "cve-2017-7308",
                "cve-2017-7472",
                "cve-2018-1000199",
                "cve-2018-12896",
                "cve-2018-18445",
                "cve-2018-18559",
                "cve-2018-5803",
                "cve-2018-8897",
                "cve-2018-9568",
                "cve-2020-14386",
                "cve-2020-14416",
                "cve-2020-25705",
                "cve-2020-29373",
                "cve-2021-22555",
                "cve-2021-26708",
                "cve-2021-4034",
                "cve-2022-2590",
                "cve-2022-4378",
                "delete_module01",
                "delete_module02",
                "delete_module03",
                "epoll_ctl01",
                "epoll_ctl04",
                "eventfd01",
                "execveat03",
                "fallocate02",
                "fallocate04",
                "fallocate05",
                "fanotify01",
                "fanotify02",
                "fanotify03",
                "fanotify04",
                "fanotify05",
                "fanotify06",
                "fanotify07",
                "fanotify08",
                "fanotify09",
                "fanotify10",
                "fanotify11",
                "fanotify12",
                "fanotify13",
                "fanotify14",
                "fanotify15",
                "fanotify16",
                "fanotify17",
                "fanotify18",
                "fanotify19",
                "fanotify20",
                "fanotify21",
                "fanotify22",
                "fcntl06",
                "fcntl06_64",
                "fcntl13",
                "fcntl13_64",
                "fcntl18",
                "fcntl18_64",
                "fcntl23",
                "fcntl23_64",
                "fcntl24",
                "fcntl24_64",
                "fcntl25",
                "fcntl25_64",
                "fcntl26",
                "fcntl26_64",
                "fcntl31",
                "fcntl31_64",
                "fcntl32",
                "fcntl32_64",
                "fcntl33",
                "fcntl33_64",
                "fcntl35",
                "fcntl35_64",
                "fcntl37",
                "fcntl37_64",
                "fcntl38",
                "fcntl38_64",
                "fcntl39",
                "fcntl39_64",
                "fdatasync02",
                "fdatasync03",
                "finit_module01",
                "fork14",
                "fs_di",
                "fsconfig02",
                "fsetxattr02",
                "fstatat01",
                "fsync03",
                "ftrace_regression02",
                "futex_cmp_requeue02",
                "futex_wake04",
                "futimesat01",
                "fw_load",
                "get_mempolicy01",
                "get_mempolicy02",
                "getcpu01",
                "getdents01",
                "getdents02",
                "getegid01_16",
                "getegid02_16",
                "geteuid01_16",
                "geteuid02_16",
                "getgroups01_16",
                "getgroups03_16",
                "getitimer01",
                "getpriority01",
                "getpriority02",
                "getresgid01_16",
                "getresgid02_16",
                "getresgid03_16",
                "getresuid01_16",
                "getresuid02_16",
                "getresuid03_16",
                "getrusage02",
                "getsockopt01",
                "getsockopt01",
                "getxattr05",
                "hugemmap06",
                "init_module01",
                "inotify02",
                "inotify04",
                "inotify05",
                "inotify06",
                "inotify10",
                "inotify11",
                "input01",
                "input02",
                "input04",
                "input05",
                "io_cancel01",
                "io_cancel02",
                "io_destroy01",
                "io_destroy02",
                "io_getevents01",
                "io_getevents02",
                "io_pgetevents02",
                "io_setup01",
                "io_setup02",
                "io_submit01",
                "io_submit02",
                "io_submit03",
                "ioctl07",
                "ioctl09",
                "ioctl_loop04",
                "ioctl_loop05",
                "ioctl_ns02",
                "ioctl_ns03",
                "ioperm01",
                "ioperm02",
                "iopl01",
                "iopl02",
                "ioprio_get01",
                "ioprio_set01",
                "ioprio_set02",
                "ioprio_set03",
                "kcmp01",
                "kcmp02",
                "keyctl01",
                "keyctl03",
                "keyctl05",
                "keyctl06",
                "kill10",
                "ksm02",
                "ksm02_1",
                "ksm04",
                "ksm04_1",
                "ksm06",
                "ksm06_1",
                "ksm06_2",
                "lchown01_16",
                "lchown02_16",
                "leapsec01",
                "linkat02",
                "llseek01",
                "lock_torture",
                "lremovexattr01",
                "lseek11",
                "ltp_acpi",
                "madvise01",
                "madvise02",
                "madvise08",
                "madvise10",
                "mallinfo02",
                "mbind01",
                "mbind02",
                "mbind03",
                "mbind04",
                "membarrier01",
                "memcg_control",
                "memcg_regression",
                "memcg_test_3",
                "memcontrol02",
                "memfd_create03",
                "migrate_pages01",
                "migrate_pages02",
                "migrate_pages03",
                "mincore01",
                "mincore02",
                "mincore03",
                "mincore04",
                "mknod07",
                "mknodat02",
                "mlock01",
                "mlock02",
                "mlock04",
                "mlock201",
                "mlock202",
                "mlock203",
                "mlockall01",
                "mlockall02",
                "mlockall03",
                "mmap10_2",
                "mmap10_3",
                "mmap10_4",
                "mmap12",
                "mmap13",
                "mmap14",
                "mmapstress07",
                "mount01",
                "mount02",
                "mount06",
                "mount_setattr01",
                "mprotect01",
                "msgget05",
                "msync03",
                "msync04",
                "munlock01",
                "munlock02",
                "munlockall01",
                "open02",
                "open06",
                "open07",
                "open14",
                "openat03",
                "openat201",
                "openat202",
                "openat203",
                "perf_event_open01",
                "personality01",
                "personality02",
                "pidfd_getfd01",
                "pidfd_getfd02",
                "pidfd_open01",
                "pidfd_open02",
                "pidfd_open03",
                "pidfd_open04",
                "pidfd_send_signal01",
                "pidfd_send_signal02",
                "pivot_root01",
                "ppoll01",
                "prctl01",
                "prctl02",
                "prctl06",
                "prctl07",
                "prctl08",
                "prctl10",
                "process_vm_readv02",
                "process_vm_readv03",
                "process_vm_writev01",
                "process_vm_writev02",
                "ptem01",
                "ptrace01",
                "ptrace02",
                "ptrace03",
                "ptrace04",
                "ptrace05",
                "ptrace10",
                "ptrace11",
                "pwritev03",
                "pwritev03_64",
                "quotactl01",
                "quotactl02",
                "quotactl03",
                "quotactl04",
                "quotactl05",
                "quotactl06",
                "quotactl07",
                "quotactl08",
                "quotactl09",
                "read02",
                "readahead01",
                "readahead02",
                "readdir21",
                "readlink03",
                "readlinkat02",
                "recv01",
                "recvfrom01",
                "recvmsg01",
                "remap_file_pages02",
                "rename11",
                "renameat01",
                "renameat201",
                "renameat202",
                "request_key01",
                "request_key02",
                "request_key03",
                "rt_sigpending02",
                "rt_sigprocmask01",
                "rt_sigqueueinfo01",
                "rt_sigtimedwait01",
                "rtc01",
                "runpwtests01",
                "runpwtests02",
                "runpwtests03",
                "runpwtests04",
                "runpwtests06",
                "sched_cli_serv",
                "sched_get_priority_max01",
                "sched_get_priority_min01",
                "sched_getattr01",
                "sched_getattr02",
                "sched_rr_get_interval02",
                "sched_rr_get_interval03",
                "sched_setaffinity01",
                "sched_setattr01",
                "sched_setparam01",
                "sched_setparam02",
                "sched_setparam03",
                "sched_setparam04",
                "sched_setparam05",
                "sched_setscheduler02",
                "sched_stress",
                "select01",
                "select02",
                "semctl08",
                "send01",
                "send02",
                "sendfile02",
                "sendfile02_64",
                "sendfile04",
                "sendfile04_64",
                "sendfile05",
                "sendfile05_64",
                "sendmsg01",
                "sendto01",
                "set_thread_area01",
                "setdomainname02",
                "setfsgid01",
                "setfsgid02",
                "setfsgid03",
                "setfsgid03_16",
                "setfsuid01",
                "setfsuid02",
                "setfsuid03",
                "setfsuid04",
                "setfsuid04_16",
                "setgroups01_16",
                "setgroups02_16",
                "setgroups03_16",
                "setgroups04_16",
                "sethostname02",
                "setitimer02",
                "setpgid01",
                "setpriority01",
                "setresgid01_16",
                "setresgid04_16",
                "setreuid04_16",
                "setreuid07_16",
                "setrlimit01",
                "setrlimit02",
                "setrlimit03",
                "setsockopt01",
                "setsockopt08",
                "settimeofday01",
                "settimeofday02",
                "setxattr03",
                "sgetmask01",
                "sigaction01",
                "sigpending02",
                "sigprocmask01",
                "sigtimedwait01",
                "sigwaitinfo01",
                "smt_smp_affinity",
                "smt_smp_enabled",
                "socket01",
                "socketcall01",
                "socketcall02",
                "socketcall03",
                "socketpair01",
                "sockioctl01",
                "ssetmask01",
                "stat04",
                "stat04_64",
                "statx01",
                "statx04",
                "statx06",
                "statx08",
                "swapoff01",
                "swapoff02",
                "swapon01",
                "swapon02",
                "swapon03",
                "switch01",
                "sync01",
                "sync_file_range01",
                "syncfs01",
                "sysinfo03",
                "syslog11",
                "syslog12",
                "tbio",
                "tee01",
                "tee02",
                "tgkill02",
                "tgkill03",
                "time-schedule01",
                "timens01",
                "timer_create01",
                "timer_create02",
                "timer_create03",
                "timer_delete01",
                "timer_delete02",
                "timer_getoverrun01",
                "timer_gettime01",
                "timer_settime02",
                "timerfd04",
                "timerfd_gettime01",
                "timerfd_settime01",
                "times01",
                "times03",
                "tpci",
                "uaccess",
                "umip_basic_test",
                "umount01",
                "umount02",
                "umount03",
                "umount2_01",
                "umount2_02",
                "unshare01",
                "userfaultfd01",
                "ustat01",
                "ustat02",
                "vhangup01",
                "vhangup02",
                "vma02",
                "vma04",
                "vmsplice01",
                "vmsplice02",
                "vmsplice03",
                "vmsplice04",
                "wait403",
                "waitid10",
                "writetest01",

                // These tests fail when an init is run in the container to set up /apex.
                // TODO(https://fxbug.dev/129839) re-enable these tests
                "chdir01",
                "close_range01",
                "fgetxattr01",
                "fremovexattr01",
                "fremovexattr02",
                "fsetxattr01",
                "fstatfs01",
                "fstatfs01_64",
                "fsync01",
                "ioctl05",
                "ioctl08",
                "ioctl_loop03",
                "ioctl_loop06",
                "mkdir09",
                "mmapstress04",
                "mount04",
                "rename01",
                "rename03",
                "rename04",
                "rename05",
                "rename06",
                "rename07",
                "rename08",
                "rename10",
                "rename12",
                "rename13",
                "setxattr01",
                "statfs01",
                "statfs01_64",
                "statvfs01",
                "utime01",
                "utime02",
                "utime03",
                "utime04",
                "utime05",
            ],
        },
        {
            type: "skip",
            matchers: [
                // TODO(fxbug.dev/127724) Re-enable once flake is resolved.
                "epoll_wait04",

                // TODO(fxbug.dev/128437) Re-enable once flake is resolved.
                "pth_str01",

                // TODO(fxbug.dev/128404) Re-enable once flake is resolved.
                "kill03",

                // TODO(fxbug.dev/127693) Re-enable once flake is resolved.
                "waitid07",

                // TODO(fxbug.dev/127726) Re-enable once flake is resolved.
                "waitid08",

                // TODO(fxbug.dev/128184) Re-enable once flake is resolved.
                "linkat01",

                // TODO(fxbug.dev/128583) Re-enable once flake is resolved.
                "sigwait01",

                // Flaky test.
                "cve-2017-17052",
                "io_pgetevents01",
                "select03",
                "setrlimit02",

                // These tests hang
                "creat07",

                // Tests reach unexpected Abort
                "clock_gettime01",
                "fork14",
                "getdtablesize01",
                "gettimeofday02",
                "io_uring01",
                "kill10",
                "mmapstress01",
                "perf_event_open02",
                "pipe07",
                "rename14",
                "rt_sigsuspend01",
                "setitimer01",
                "sysfs02",

                // TODO(fxbug.dev/129388) Removing these skip tests leads to the entire ltp_tests_bundle_w
                // to fail on core.x64-vg-debug. No failure was observed on vg-release.
                "wait402",
                "wait403",
                "waitid10",
                "wqueue01",
                "wqueue02",
                "wqueue03",
                "wqueue04",
                "wqueue05",
                "wqueue06",
                "wqueue07",
                "wqueue08",
                "wqueue09",
                "writetest",
                "writev01",
                "writev03",

                // Times out.
                "cve-2017-10661",

                // Fails on debug bots due to invalid lock ordering.
                "memfd_create01",
            ],
        },
    ],
}
