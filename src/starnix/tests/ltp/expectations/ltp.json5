// Copyright 2023 The Fuchsia Authors.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
{
    actions: [
        {
            type: "expect_pass",
            matchers: [
                "*",
            ],
        },
        {
            type: "expect_failure",
            matchers: [
                "add_key01",
                "add_key03",
                "adjtimex01",
                "adjtimex02",
                "adjtimex03",
                "bind02",
                "bpf_prog01",
                "bpf_prog05",
                "clock_adjtime01",
                "clock_adjtime02",
                "clock_settime01",
                "clock_settime02",
                "clone05",
                "clone08",
                "clone09",
                "cpuacct_1_1",
                "cve-2015-7550",
                "cve-2016-5195",
                "cve-2016-9604",
                "cve-2016-9793",
                "cve-2017-12192",
                "cve-2017-12193",
                "cve-2017-15274",
                "cve-2017-15299",
                "cve-2017-15951",
                "cve-2017-17807",
                "cve-2017-18075",
                "cve-2017-6951",
                "cve-2017-7308",
                "cve-2017-7472",
                "cve-2018-1000199",
                "cve-2018-11508",
                "cve-2018-5803",
                "cve-2018-8897",
                "cve-2018-9568",
                "cve-2020-11494",
                "cve-2021-4034",
                "cve-2022-2590",
                "delete_module02",
                "epoll_wait06",
                "fallocate04",
                "mmap08",
                "readlinkat01",

                // 23 requires F_SETLEASE
                "fcntl23",
                "fcntl23_64",

                // 24 requires F_SETLEASE, and does not run on tmpfs.
                "fcntl24",
                "fcntl24_64",
                "fcntl25",
                "fcntl25_64",
                "fcntl26",
                "fcntl26_64",

                // 31 requires F_SETSIG.
                "fcntl31",
                "fcntl31_64",
                "fcntl32",
                "fcntl32_64",
                "fcntl33",
                "fcntl33_64",
                "fdatasync03",
                "fs_di",
                "fsetxattr02",
                "fstatat01",
                "futimesat01",
                "getitimer01",
                "getpriority01",
                "getpriority02",
                "io_cancel01",
                "io_cancel02",
                "io_getevents01",
                "io_getevents02",
                "io_setup01",
                "io_setup02",

                // Skipped with tmpfs.
                "ioctl_loop05",
                "ioprio_get01",
                "ioprio_set01",
                "ioprio_set02",
                "ioprio_set03",
                "keyctl01",
                "keyctl03",
                "keyctl05",
                "keyctl06",
                "leapsec01",
                "madvise02",
                "madvise08",
                "membarrier01",
                "mincore01",
                "mincore02",
                "mincore03",
                "mincore04",
                "mlock02",
                "mlock201",
                "mlock203",
                "mlockall01",
                "mlockall02",
                "mlockall03",
                "mmap12",
                "mmap14",
                "mmap20",
                "mmapstress07",
                "mount02",
                "mount06",
                "mprotect01",
                "mprotect05",
                "msync03",
                "msync04",
                "munlock02",
                "munlockall01",
                "perf_event_open01",

                // Needs /proc/sys/fs/pipe-user-pages-soft
                "pipe15",
                "pivot_root01",
                "prctl01",
                "prctl02",
                "prctl06",
                "prctl07",
                "prctl08",
                "prctl10",
                "ptrace10",
                "pwritev03",
                "pwritev03_64",
                "quotactl04",
                "quotactl08",
                "quotactl09",

                // Depends on IO stats in /proc/<pid>/io .
                "readahead02",
                "remap_file_pages02",
                "request_key01",
                "request_key02",
                "request_key03",
                "rt_sigtimedwait01",
                "runpwtests03",
                "runpwtests04",
                "runpwtests06",
                "sched_getattr01",
                "sched_getattr02",
                "sched_rr_get_interval02",
                "sched_rr_get_interval03",
                "sched_setattr01",
                "sched_setparam05",
                "sched_setscheduler02",
                "send02",
                "setitimer01",
                "setitimer02",
                "setpgid01",
                "setpriority01",
                "setrlimit03",
                "settimeofday01",
                "settimeofday02",
                "setxattr03",
                "sigtimedwait01",
                "sigwaitinfo01",
                "splice07",
                "sockioctl01",
                "statx04",
                "statx06",
                "statx11",
                "sync01",
                "time-schedule01",

                // Depends on real contents in /proc/sys/kernel/perf_event_mlock_kb
                "cve-2015-3290",

                // Depends on real contents in /proc/sys/net/ipv4/ping_group_range
                "cve-2017-2671",

                // Needs working sched_getcpu()
                "perf_event_open02",

                // https://fxbug.dev/42078242
                "times03",
                "umount02",
                "umount2_01",
                "umount2_02",
                "unshare01",
                "utsname03_clone",
                "writetest01",

                // These tests fail when an init is run in the container to set up /apex.
                // TODO(https://fxbug.dev/42080241) re-enable these tests
                "mmapstress04",
            ],
        },
        {
            type: "skip",
            matchers: [
                // Skip to handle transition from passing to failing.
                "cve-2018-19854",

                // https://fxbug.dev/42085930
                "fgetxattr01",

                // Skip to handle transition from passing to failing.
                "gettimeofday01",

                // Skip to handle transition from passing to failing. It fails due to: "No supported filesystems"
                "getxattr03",

                // Skip to handle transition from passing to failing.
                "mount04",

                // https://fxbug.dev/42085553
                "open04",

                // Flaky test.
                "cve-2017-17052",
                "io_pgetevents01",
                "recvmsg01",
                "rename14",
                "select03",

                // Causes an OOM when /dev/loop-control is available.
                "fallocate05",

                // These tests hang
                "aio01",
                "creat07",
                "fork14",

                // TODO(https://fxbug.dev/322874889) requires a working sched_setaffinity
                "getcpu01",

                // Makes all following tests to fail.
                "kill10",

                // Times out.
                "cve-2017-10661",

                // TODO(b/287121317): Remove after timer_settime03 is fixed.
                "cve-2018-12896",

                // These tests are time-consuming, so they often cause timeouts in the
                // corresponding suites. Consider moving them to separate bundles.
                "cve-2011-0999",
                "cve-2014-0196",
                "cve-2016-7117",
                "dio*",
                "fs_fill",
                "fs_inod01",
                "hackbench01",
                "hackbench02",
                "linker01",
                "mtest06",
                "nanosleep01",

                // Test sometimes timeout instead of failing
                "starvation",
            ],
        },
    ],
}
