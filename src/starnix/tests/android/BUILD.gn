# Copyright 2021 The Fuchsia Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

import("//build/components.gni")
import("//build/python/python_host_test.gni")
import(
    "//src/lib/testing/expectation/fuchsia_test_component_with_expectations.gni")
import("//src/starnix/tests/starnix_test_subpackages.gni")

group("tests") {
  testonly = true
  if (target_cpu == "x64" && !is_asan) {
    deps = [ ":android" ]
  }
}

fuchsia_test_component("sh_test") {
  check_references = false
  manifest = "meta/sh_test.cml"
  deps = [ "//src/starnix/tests:starnix_test" ]
  test_type = "starnix"
}

fuchsia_test_component("boringssl_self_test64") {
  check_references = false
  manifest = "meta/boringssl_self_test64.cml"
  test_type = "starnix"
}

fuchsia_test_package("android") {
  test_components = [
    ":boringssl_self_test64",
    ":sh_test",
  ]

  if (target_cpu == "x64") {
    subpackages = starnix_test_subpackages
    subpackages += [ "//src/starnix/containers/bionic:bionic_package" ]
  }

  deps = [ "//src/lib/testing/expectation:expectation_comparer" ]
}
