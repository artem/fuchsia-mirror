// Copyright 2022 The Fuchsia Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
{
    actions: [
        {
            type: "expect_pass",
            matchers: [
                "*",
            ],
        },
        {
            type: "skip",
            matchers: [
                // Tests that flake in Fuchsia's CQ.
                // https://fxbug.dev/112125
                "AllInetTests/TcpSocketTest.ClosedWriteBlockingSocket/*",

                // https://fxbug.dev/112126
                "AllInetTests/TcpSocketTest.PollWithFullBufferBlocks/*",

                // https://fxbug.dev/112041
                "AllInetTests/SimpleTcpSocketTest.SynRcvdOnListenerShutdown/*",

                // This test hangs until cl/390312274 is in the Fuchsia SDK.
                "AllInetTests/TcpSocketTest.SendUnblocksOnSendBufferIncrease/*",

                // https://fxbug.dev/62744
                // Skip flaky test.
                "AllInetTests/SimpleTcpSocketTest.SelfConnectSendRecv/*",

                // https://fxbug.dev/73043
                "AllInetTests/SimpleTcpSocketTest.NonBlockingConnect_PollWrNorm/*",

                // https://fxbug.dev/85279
                "AllInetTests/SimpleTcpSocketTest.ShutdownReadConnectingSocket/*",

                // https://fxbug.dev/85279
                "AllInetTests/SimpleTcpSocketTest.ShutdownWriteConnectingSocket/*",

                // https://fxbug.dev/85279
                "AllInetTests/SimpleTcpSocketTest.ShutdownReadWriteConnectingSocket/*",
            ],
        },
        {
            type: "expect_failure",
            matchers: [
                // TODO(https://fxbug.dev/45262): support sendmmsg
                "AllTCPSockets/AllSocketPairTest.BasicSendmmsg/*",
                "AllTCPSockets/AllSocketPairTest.SendmmsgIsLimitedByMAXIOV/*",

                // TODO(https://fxbug.dev/45260): support recvmmsg
                "AllTCPSockets/AllSocketPairTest.BasicRecvmmsg/*",
                "AllTCPSockets/AllSocketPairTest.RecvmmsgTimeoutBeforeRecv/*",
                "AllTCPSockets/AllSocketPairTest.RecvmmsgInvalidTimeout/*",

                // Fuchsia does not implement recvmsg correctly for TCP.
                "AllTCPSockets/AllSocketPairTest.SendmsgRecvmsg10KB/*",
                "AllTCPSockets/AllSocketPairTest.SendmsgRecvmsg16KB/*",
                "AllTCPSockets/AllSocketPairTest.SendmsgRecvmsgMsgCtruncNoop/*",
                "AllTCPSockets/AllSocketPairTest.RecvmsgMsghdrFlagsCleared/*",
                "AllTCPSockets/AllSocketPairTest.RecvmsgPeekMsghdrFlagsCleared/*",

                // Fuchsia does not implement MSG_WAITALL for TCP.
                "AllTCPSockets/AllSocketPairTest.RecvWaitAll/*",
                "AllTCPSockets/AllSocketPairTest.RecvWaitAllDontWait/*",
                "AllTCPSockets/AllSocketPairTest.RecvTimeoutWaitAll/*",

                // https://fxbug.dev/74836
                "AllTCPSockets/AllSocketPairTest.SetAndGetBooleanSocketOptions/*",

                // https://fxbug.dev/74639
                "AllTCPSockets/AllSocketPairTest.GetSetSocketRcvlowatOption/*",

                // https://fxbug.dev/20628
                "AllInetTests/TcpSocketTest.MsgTrunc/*",

                // https://fxbug.dev/20628
                "AllInetTests/TcpSocketTest.MsgTruncWithCtrunc/*",

                // https://fxbug.dev/20628
                "AllInetTests/TcpSocketTest.MsgTruncWithCtruncOnly/*",

                // https://fxbug.dev/20628
                "AllInetTests/TcpSocketTest.MsgTruncLargeSize/*",

                // https://fxbug.dev/20628
                "AllInetTests/TcpSocketTest.MsgTruncPeek/*",

                // https://fxbug.dev/41617
                "AllInetTests/TcpSocketTest.TcpInqSetSockOpt/*",

                // https://fxbug.dev/41617
                "AllInetTests/TcpSocketTest.TcpInq/*",

                // https://fxbug.dev/41617
                "AllInetTests/TcpSocketTest.TcpSCMPriority/*",
            ],
        },
    ],
}