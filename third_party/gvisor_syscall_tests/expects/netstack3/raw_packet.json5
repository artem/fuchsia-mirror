// Copyright 2023 The Fuchsia Authors. All rights reserved.
// Use of this source code is governed by a BSD-style license that can be
// found in the LICENSE file.
{
    actions: [
        {
            type: "skip",
            matchers: [
                // TODO(https://fxbug.dev/339692009): Support HDRINCL raw sockets.
                "RawHDRINCL.SendAndReceive",
                "RawHDRINCL.SendAndReceiveDifferentAddress",
            ],
        },
        {
            type: "expect_failure",
            matchers: [
                // Not-yet-supported socket options on raw packet sockets.
                "AllInetTests/RawPacketTest.GetSocketAcceptConn/*",
                "AllInetTests/RawPacketTest.GetSocketError/*",
                "AllInetTests/RawPacketTest.GetSocketErrorBind/*",
                "AllInetTests/RawPacketTest.SetAndGetSocketLinger/*",
                "AllInetTests/RawPacketTest.SetSocketDetachFilterNoInstalledFilter/*",
                "AllInetTests/RawPacketTest.SetSocketSendBuf/*",
                "AllInetTests/RawPacketTest.SetSocketSendBufAboveMax/*",
                "AllInetTests/RawPacketTest.SetSocketSendBufBelowMin/*",

                // TODO(https://fxbug.dev/42175797): Support Raw IP Sockets.
                "AllInetTests/RawSocketTest.BindConnectSendAndReceive/*",
                "AllInetTests/RawSocketTest.BindSendAndReceive/*",
                "AllInetTests/RawSocketTest.BindThenGetSockName/*",
                "AllInetTests/RawSocketTest.BindToDevice/*",
                "AllInetTests/RawSocketTest.BindToInvalid/*",
                "AllInetTests/RawSocketTest.BindToLocalhost/*",
                "AllInetTests/RawSocketTest.BindToWildcard/*",
                "AllInetTests/RawSocketTest.ConnectOnIPv6Socket/*",
                "AllInetTests/RawSocketTest.ConnectThenGetSockName/*",
                "AllInetTests/RawSocketTest.ConnectToLoopback/*",
                "AllInetTests/RawSocketTest.FailGetPeerNameBeforeConnect/*",
                "AllInetTests/RawSocketTest.FailShutdownWithoutConnect/*",
                "AllInetTests/RawSocketTest.GetPeerName/*",
                "AllInetTests/RawSocketTest.MultipleSocketReceive/*",
                "AllInetTests/RawSocketTest.PollTriggeredOnWrite/*",
                "AllInetTests/RawSocketTest.RecvBufLimits/*",
                "AllInetTests/RawSocketTest.RecvBufLimitsEmptyRecvBuffer/*",
                "AllInetTests/RawSocketTest.SendAndReceive/*",
                "AllInetTests/RawSocketTest.SendAndReceiveViaConnect/*",
                "AllInetTests/RawSocketTest.SendWithoutConnectFails/*",
                "AllInetTests/RawSocketTest.SetSocketDetachFilterNoInstalledFilter/*",
                "AllInetTests/RawSocketTest.SetSocketRecvBuf/*",
                "AllInetTests/RawSocketTest.SetSocketRecvBufAboveMax/*",
                "AllInetTests/RawSocketTest.SetSocketRecvBufBelowMin/*",
                "AllInetTests/RawSocketTest.SetSocketSendBuf/*",
                "AllInetTests/RawSocketTest.SetSocketSendBufAboveMax/*",
                "AllInetTests/RawSocketTest.SetSocketSendBufBelowMin/*",
                "AllInetTests/RawSocketTest.ShutdownReadNoop/*",
                "AllInetTests/RawSocketTest.ShutdownWriteNoop/*",
                "AllRawPacketMsgSizeTest/RawPacketMsgSizeTest.SendTooLong/*",
                "AllRawPacketMsgSizeTest/RawPacketMsgSizeTest.SpliceTooLong/*",
                "AllRawSocketTests/RawSocketICMPv6TypeTest.FilterDeliveredPackets/*",
                "RawHDRINCL.BindToInvalid",
                "RawHDRINCL.BindToLocalhost",
                "RawHDRINCL.ConnectToLoopback",
                "RawHDRINCL.FailShutdownWithoutConnect",
                "RawHDRINCL.NotReadableAfterWrite",
                "RawHDRINCL.SendAndReceiveIPHdrIncl",
                "RawHDRINCL.SendWithoutConnectFails",
                "RawHDRINCL.WriteTooSmall",
                "RawSocketICMPTest.BindConnectSendAndReceive",
                "RawSocketICMPTest.BindSendAndReceive",
                "RawSocketICMPTest.GetSocketAcceptConn",
                "RawSocketICMPTest.ICMPv6FilterNotSupported",
                "RawSocketICMPTest.IPv6ChecksumNotSupported",
                "RawSocketICMPTest.MultipleSocketReceive",
                "RawSocketICMPTest.SendAndReceive",
                "RawSocketICMPTest.SendAndReceiveBadChecksum",
                "RawSocketICMPTest.SendAndReceiveViaConnect",
                "RawSocketICMPTest.SetAndGetSocketLinger",
                "RawSocketICMPv6Test.GetPartialFilterSucceeds",
                "RawSocketICMPv6Test.InitialFilterPassesAll",
                "RawSocketICMPv6Test.MsgTooSmallToFillChecksumFailsSend",
                "RawSocketICMPv6Test.PingSuccessfully",
                "RawSocketICMPv6Test.SetSockOptIPv6ChecksumFails",
                "RawSocketTest.BindReceive",
                "RawSocketTest.IPv6Checksum_ValidateAndCalculate",
                "RawSocketTest.IPv6ProtoRaw",
                "RawSocketTest.IPv6SendMsg",
                "RawSocketTest.ReceiveHopLimit",
                "RawSocketTest.ReceiveIPPacketInfo",
                "RawSocketTest.ReceiveIPv6PacketInfo",
                "RawSocketTest.ReceiveTClass",
                "RawSocketTest.ReceiveTOS",
                "RawSocketTest.ReceiveTTL",
                "RawSocketTest.SetIPv6ChecksumError_MultipleOf2",
            ],
        },
    ],
}
